---
title: "Caribou Demographic Projection - interesting & informative title TBD"
author:
  - name: Josie Hughes
    email: josie.hughes@ec.gc.ca
    institute: [ECCC]
    correspondence: true
  - name: Sarah Endicott
    email: sarah.endicott@ec.gc.ca
    institute: [ECCC]
    correspondence: false
  - name: Cheryl A Johnson
    email: cheryl-ann.johnson@ec.gc.ca
    institute: [ECCC]
    correspondence: false
  - name: Anna M Calvert
    email: anna.calvert@ec.gc.ca
    institute: [ECCC]
    correspondence: false
institute:
  - ECCC: Environment and Climate Change Canada 
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::word_document2:
      fig_caption: yes
      number_sections: no
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
bibliography: CaribouDemographicModel.bib
csl: "../templates/journal-of-forest-ecology-and-management.csl" # Insert path for the bib-style
abstract: |
  Text of abstract
keywords: |
  keyword 1; keyword 2; keyword 3
highlights: |
  These are the highlights. 
editor_options: 
  chunk_output_type: inline
---

<!-- This is the format for text comments that will be ignored during renderings. Do not put R code in these comments because it will not be ignored. -->

<!-- With the following code you can access and display values from the yml header above. -->
<!-- Link to data here: https://drive.google.com/file/d/179lw6MPK4l3xGmded9kofzJkB6VlJVb9/view?usp=sharing -->

Keywords: `r rmarkdown::metadata$keywords`

Highlights: `r rmarkdown::metadata$highlights`

<!-- The following code chunk defines some general settings how code chunks should behave. -->

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "../figs/",
  dpi = 300
)
```

<!-- The actual document text starts here: -->

# Introduction

Motivating example - forecasting impacts of disturbance - WBI and RoF example. In order to reduce uncertainty, need to integrate local information on current state of the population into forecasts.

Lots of variability among caribou ranges in monitoring data: recency, duration, types of data. E.g. 27+ consecutive years of both telemetry-survival and calf/cow-ratios in most Alberta ranges, vs. 1-4 years of data in most Ontario ranges (and that's old) *note we may want to be careful about inter-province comparisons for political reasons, but the variation is super relevant when to-date we've had the same 'rules' apply across the board... 

In Missisa (and other places, esp Ontario) available local data are old and limited. Not clear how indicative older data is of state of population. Need new data to resolve questions, but what type, how much is enough. Can't monitor in great detail everywhere all the time. More generally, need for tools to help assess the value of additional monitoring and the best way to invest additional monitoring resources, given the info that is already available. 

Topics of interest, questions, goals:

* How get a demographic forecast informed by local demographic data and national disturbance-demographic relationships?
* How to assess the value of collecting additional demographic data? How to prioritize whether to e.g. monitor many areas for a short time or fewer areas over the long term? 
* How much of a bias/misinterpretation can be (has been?) incurred if we don't recognize local differences?
* How does that value depend on current status of the range, available existing demographic data, and projected future disturbance. When and why is more information required, and when do we know enough?
* Provide decision support tools to enable others to get forecasts informed by their local data and national models, and assess the value of monitoring scenarios. 

# Methods

```{r setup2}
library(ggplot2)
library(dplyr)
library(stringr)
library(tidyr)
library(purrr)
library(ggpubr)
library(MetBrewer)
library(here)
library(tmap)
library(sf)

devtools::load_all(here::here())

#set paths
data_path_raw <- "analysis/data/raw_data/"
data_path_drvd <- "analysis/data/derived_data"

cd <- here::here()
app_path <- gsub("Caribou-Demographic-Projection-Paper","BayesianCaribouDemographicProjection",cd,fixed=T)

pal_nm <- "Redon"

fig_widths <- c(min = 1.18, single = 3.543, mid = 5.51, two = 7.48)

runScenarios = F 
doPriorCalibration=F #Note the prior calibration is time consuming. 
```
TO DO: build large table of all parameters as the various sections are written. Adjust UI for consistent terminology along the way.

## Caribou population monitoring: survival and recruitment metrics

Marking of caribou cows with telemetry GPS/VHF collars is the traditional approach to estimating demographic parameters (refs/examples, e.g. key boreal caribou projections and status documents reliant on these ests, also methods papers like Courtois et al. 2003, RettieMessier 1998). 

Adult survival is estimated by tracking the fate of marked individuals (Kaplan-Meier ests) [brief description of field/logistical details - can get details from NBCKC Telemetry writeup (https://www.cclmportal.ca/sites/default/files/2021-10/Telemetry%20draft%20October%2027%202021.pdf), e.g. GPS allow for remote detection vs VHF-only require physical relocation of individual; collar sends out a
mortality signal when no longer active after a predetermined period of time; males only occasionally collared; age of collared individuals is usually unknown]

Collared females are also used in traditional estimates of recruitment (refs/examples): collared individuals are located by aircraft and then the entire group of caribou is surveyed to estimate the ratio of cows:calves in the group... Because this estimate is based on more than just the collared sample of cows, the sample size for recruitment ests is typically larger than for survival (introduce the multiplier parameter).


## A simple Bayesian IPM to integrate local demographic data and national disturbance-demographic relationships

Following [@eacker_web-based_2019], the observed number of calves $c_t$ is a binomially distributed function of the observed number of adult female caribou $a_t$ and the estimated recruitment probability $R_t$: $$c_t \sim R_t^{c_t}(1-R_t)^{a_t-c_t}.$$
We model recruitment probability as a function of anthropogenic disturbance and fire [@johnson_science_2020;@stewart_climate-informed_nodate;@dyson_existing_2022], with a log link and Gaussian distributed random year effect [@eacker_web-based_2019]: $$\log(R_t)=\beta^R_0+\beta^R_a anthro_t+\beta^R_f fireExclAnthro_t+\epsilon^R_t; \epsilon^R_t \sim \text{normal}(0,\sigma^2_{R}).$$ 
Estimated recruitment probability is adjusted for sex ratio and delayed age of first reproduction [@eacker_web-based_2019;@decesare_estimating_2012] to get expected recruits per female: $$\tilde{R}_t=\frac{R_t/2}{1+R_t/2}.$$

Also following [@eacker_web-based_2019], Kaplan-Meier estimates of observed adult female survival probability $\hat{S}_t$ and associated precisions $\tau_t$ are estimated from known-fate radio collar data using the survival R package [@therneau_modeling_2000], with precisions for years with no observed mortality estimated using a separate Bayesian model. Observed estimated survival is a Gaussian distributed function of the true survival probability: $$\hat{S_t} \sim \text{normal}(S_t,1/\tau_t).$$ 
We model true survival probability as an adjusted function of anthropogenic disturbance  [@johnson_science_2020;@stewart_climate-informed_nodate;@dyson_existing_2022], with a log link and Gaussian distributed random year effect [@eacker_web-based_2019]: $$S_t=\text{min}(46 \tilde{S_t}-0.5)/45,1); \log(\tilde{S_t})=\beta^S_0+\beta^S_a anthro_t+\epsilon^S_t; \epsilon^S_t \sim \text{normal}(0,\sigma^2_{S}).$$ 
To assess sensitivity of results to the survival estimation method, we also implemented an alternative parametric exponential survival model, wherein the state of an individual animal in year $t$ and month $m$ is Bernoulli distributed (ref IPM book): $$A_{t,m} \sim \text{Bernoulli}(S^{1/12}_t A_{t,m-1}).$$

All regression coefficients are assumed to be Gaussian distributed, with priors derived from the expected values and 95% confidence intervals estimated by Johnson et al (2020) (Table \@ref(tab:priors)). We calibrated the prior distributions so that the 95% prediction interval from the IPM matches the range between the 2.5% and 97.5% quantiles of 1000 simulated recruitment (Supplement X).  

```{r priors, echo=FALSE,message=FALSE}

source(here::here("analysis/scripts/formatPriors.R"))

knitr::kable(tbl,caption="Model priors parameters are Gaussian distributed with expected values ")
```

TO DO: 

* ensure that INF_saf_INF_r_JAGS_extentTime.txt and INF_saf_INF_r_JAGS_expSurvival2.txt are identical except for the survival observation model. Or better yet, write code to sub in correct survival model more elegantly.
* note various bits of truncation in the JAGS code to ensure R and S remain between 0 and 1 (not guaranteed given log link). Not all documented in this explanation. Bayesian wizard might know a better way. Or at least know how to explain.
* note Eacker survival method gives biased results in years when <12 months of survival data is available.
* Note I am dropping survival information for animals that are not alive at the beginning of a year to deal with censoring issues. There is probably some more elegant way to deal with this, but it won't make any difference as long as the collar deployment month is set to 1.
* add references to documentation of popGrowthJohnson and other caribouMetrics functions.
* consider & comment on alternative choices made in this example https://poissonconsulting.shinyapps.io/bboushiny/. Follow Eacker example in all particulars, change some aspects, or do comparisons?

## A method for simulating example data

### True population dynamics
Write for now assuming that caribouMetrics paper will be published somewhere.

### Observed survival from collars

### Observed recruitment from calf:cow aerial surveys

## Assessing the value of information

TO DO: how to assess or quantify value in this context. Power to distinguish increasing from decreasing population? What else?

## Scenarios

Table 1. Example ranges. Ontario demographic information from [@mnrf_state_2014]. If two numbers given for Anthropogenic disturbance they are BEAD 2010 and 2015.
*note that we've had some input on monitoring numbers from NL, BC, ON (and MB pending), so some of them may also be willing to give us case study examples to use here? Note can get details about SK1 from Phil's report.

```{r}
tbl <- "Range|Anthropogenic Disturbance|$\\lambda$|R|S|Survey Years
Missisa|0.41|0.86|14.2|80%|2008-2012
Churchill||0.96|19.5|87%|2011-2012
"
df <- read.delim(textConnection(tbl),header=FALSE,sep="|",strip.white=TRUE,stringsAsFactors=FALSE)
names(df) <- unname(as.list(df[1,]))
df <- df[-1,] # remove first row
row.names(df)<-NULL
knitr::kable(df)
```
TO DO: id examples from elsewhere to complement Ontario examples. Would be good to include an example where status is ok. What else, and why? WBI NWT ranges?
*from Anna: withouot access to actual estimates of R and S for different ranges, some potentially interesting other ranges to compare to could be an Alberta range or two, where there are ++years of R and S estimates but really low lambda (E.g. ESAR and WSAR have 27+ yrs consecutive monitoring but declining numbers and high disturbance), some sections of NWT1 that are thought to be self-sustaining and have pretty good data sets (e.g. Dehcho North and South, Hay River Lowlands with 13+yrs of S and R) -could also use other MB ranges as examples for fairly sparse data (though not as bad as ON), and QC or LAB ranges as examples of good data (e.g. how about Charlevoix for a very well monitored but tiny pop, northern QC for really broad-expanse pop, or Labrador pops have long term monitoring data but uncertain status...)

NOTE: would be great to info on number of collars per year in each example range. Though note MNRF recruitment estimates in some years came from aerial distribution surveys.
*feedback from MonitoringWG contacts includes details on collar numbers for BC, ON, NL, (MB pending); e.g. in Ontario they aim for 20-30 collars in smaller pops, 35+ in bigger pops; Labrador aims to have between 5-25 collars monitored at any one time, depending on pop size; in BC, real numbers of collared animals have ranged been between 3-59 per pop/year, varying both across-yrs-within-pop and across-pop-within-yr [with COVID yrs by far the lowest].

relevant refs: [@rettie_summary_2017];?

```{r monitoringScenarios, echo=FALSE,message=FALSE}

source(here::here("analysis/scripts/formatScenarios.R"))

knitr::kable(tbl,caption="Monitoring scenarios parameters and values (example values to stimulate discussion - what should these numbers be and why?)")
```

*Monitoring WG input from BC, ON, NL, (MB pending): lots of detail provided but generally those numbers suggest we could try values of ~3-10 [e.g. 3,6,9?] for the cow multiplier, 5-50 for collars [e.g. 5,10,20,40,60?], [not sure about renewal interval, but see SaraM email for some insights]. We know (e.g. from the MonitoringWG perspectives report/update to Rettie summary) that number of years of monitoring can be as low as 2 or as many as 20+

TO DO: figure out disturbance forecast scenarios. Can lift Mississa scenario from caribouMetrics paper. Get Churchill scenario from Colin's Lac Seul model with roads - can lift it from the Churchill full model if not easy to sub in Lac Seul. *and can maybe ask MonitoringWG contacts who seemed keen whether they'd have case studies to offer too...?

TO DO: Fire scenarios? Add high fire scenario in appendix of one by one sensitivity checks.

TO DO: run low initial population size scenario, put in appendix of one by one sensitivity checks. 

TO DO: calculate change in anthro disturbance over 5 yrs across ranges to get realistic distribution of numbers of this & justify choice of parameters. run alternative scenario to put in one by one sensitivity appendix.

```{r fig1, fig.cap="Anthropogenic disturbance and monitoring scenarios (examples to stimulate discussion).", cache=TRUE}
knitr::include_graphics(here::here("figs/forPaper/distScnscmult3ay1aSf1.png"))

```


## Decision support tool development

Integration into caribouMetrics, shiny UI, integration into SpaDES & SyncroSim.

# Results

TO DO: consider showing results in terms of average number of collars deployed per year rather than target # and renewal interval.

```{r scn1, cache=TRUE,echo=FALSE, message=FALSE,results='hide'}
if(runScenarios){
  numObsYrs=c(2);startsByYr = 30 #25
  scns=expand.grid(P=numObsYrs,sQ=c(0.5),st=startsByYr)
  scResults = runScenario(scns)

  png(here::here("figs/Figure1_Example.png"),
    height = 4, width = fig_widths["mid"], units = "in",res=600)
  print(plotRes(scResults$rr.summary.all, "Female population size",obs=scResults$obs.all,
              lowBound=0,highBound=2000,facetVars=c("P","sQ")))
  dev.off()
}

```

# Discussion

Will need a section on the fundamental assumptions of these models/aspatial nature of them, e.g. that collared cows  and cows observed in surveys are a random representative sample of the larger population, and that there is full mixing in the population so that estimated survival/recruitment rates apply equally to all animals in the population. We can discuss this with some contrasting examples, e.g. collaring 30 animals from a very small/restricted population (like Little Smoky, 308,606ha, pop size estimate 78 as of COSEWIC 2014) would likely be much more representative of the population vs. collaring 30 animals from a relatively large/expansive population (northern Quebec range Q6, 62,156,186 ha, pop size 9000 as of COSEWIC 2014). But because of the way this model is built, we assume that the sample is equally representative in either of those cases, so changing the initial starting N won't affect model performance/predictions much here... 

On a related topic to population size; Note that the stuff we got from ArtR regarding simulations for sample size does acknowledge that pops of different sizes have different monitoring requirements, and Sara's Labrador numbers also show targets relative to pop size... Since this kind of aspatial model will mostly be using small population sizes in order to see any effects, we'll jsut have to acknowledge that a caveat of this is that we're not fully able to explore all the population size effects with this model, but generally Josie has found little impact of initial population size to the results. 

We should likely also have a pgph about costs of monitoring - it'll be pretty short, cause basically we have no idea what it costs since nobody will tell us :) Through the NBCKC Monitoring Working Group work, we tried over and over to get some basic cost estimates from P/T reps and practitioners, and hit a wall - nobody wanted to tell us a thing. Don't know if we'd now find anyone is more open to sharing, but don't think we should get our hopes up. But at the very least we'll want to acknowledge that we haven't accounted for relative costs of monitoring... [e.g. costs outlined in the Telemetry guidance report from the MonitoringWG: "Expenses to consider in radio-collared monitoring will vary, based on: helicopter (or other aircraft) use, purchase of tracking collars, data fees associated with the collars (the cost of which varies by operating system, recording frequency and data transmission frequency), and live-capture equipment (3 or more sets of capture nets and associated buckets, a netting gun, and ankle hobbles)"]
-->perhaps the keen MonitoringWG contacts would be willing to provide even really rough cost estimates, and/or even jsut a relative sense of how different it would be to e.g. monitor a few pops for many yrs vs lots of pops for a short time...?




# Acknowledgements

<!-- The following line inserts a page break  -->

\newpage

# References

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

::: {#refs}
:::

\newpage

# Appendix

## Calibration of Priors

```{r priorCalibration, cache=TRUE,echo=FALSE, message=FALSE,results='hide'}
if(doPriorCalibration){

  #TO DO: move CaribouDemo_v1.15Reduce.R to paper directory. And produce pngs, rather than pdfs.
  source(here::here("analysis/scripts/calibratePriors.R"))
}else{
  KS<-read.csv(here::here("tabs/SurvKSAll.csv"))
  KSRec<-read.csv(here::here("tabs/RecKSAll.csv"))

}
  png(here::here("figs/PriorKSDists.png"),
    height = 4, width = fig_widths["two"], units = "in",res=600)
    base = ggplot(KS,aes(x=lse,y=KSDistance,color=sse))+
    geom_point()+facet_grid(scn~ssv,labeller="label_both",scales="free_y")+theme_bw()+ylab("Kolmogorov-Smirnov Distance")+xlab("lse: multiplier on SD of survival intercept")
    print(base)
  dev.off()
  
  png(here::here("figs/PriorKSDistsRec.png"),
    height = 4, width = fig_widths["two"], units = "in",res=600)
    base = ggplot(KSRec,aes(x=lre,y=KSDistance,color=sre))+
    geom_point()+facet_grid(scn~srv,labeller="label_both",scales="free_y")+theme_bw()+ylab("Kolmogorov-Smirnov Distance")+xlab("lre: multiplier on SD of recruitment intercept")
    print(base)
  dev.off()
```


```{r PriorKSDists, fig.cap="Prior parameter values should be set so that, given minimal monitoring data ('All' scenario: 1 year of 1 collar per year), the posterior survival distribution is similar to the distribution of simulated outcomes from the national model, measured here by Komogorov-Smirnov distance [ks.test function in @R_R_2022]. Priors should also be vague enough so that, given intensive monitoring of populations where survival is higher or lower than the national average ('High' and 'Low' scenarios: 15 years of 45 collars per year from 97.5% and 2.5% quantiles of the national model), posteriors reflect local survival, rather than priors from the national model. When the multiplier on the prior standard deviation of the survival intercept (lse: $\\beta^S_0$ in Table @ref(tab:priors)) is 5, the prior is informative enough to meet the former condition, and vague enough to meet the latter. Given lse=5, low values of the mean standard deviations of the prior distribution of the random effect of year on survival (sse=0.034784, ssv=0.01, $\\sigma^2_S$ in Table @ref(tab:priors)) yield priors that meet both conditions (Figs @ref(fig:priorAllFits) and @ref(fig:priorLowFits)). Anthropogenic disturbance is set to 0 in these scenarios." , cache=TRUE}
knitr::include_graphics(here::here("figs/PriorKSDists.png"))

#TO DO: figure out what to do about citations and references in figure captions. Or just fill them in manually at a later stage.

#Note: file wouldn't knit for Anna without access to all the newest png files below, so just commenting out the problem ones for now
```

```{r PriorAllFits, fig.cap="Differences between posterior predictive survival distributions from the Bayesian model ('local') and simulated outcomes from the national model ('national'), assuming minimal monitoring (1 years of 1 collar per year) of populations from the 50% quantile of the national model. In these examples, the standard deviation the random effect prior (ssv: $\\sigma^2_S$ in Table @ref(tab:priors)) is 0.03, and  anthropogenic disturbance is 0. Bands show 95% posterior predictive intervals ('local'), and the 2.5th and 97.5th percentiles for 1000 sample populations from the national model.",  cache=TRUE}
# COMMENTED OUT FOR NOW CAUSE I DIDN"T HAVE ACCESS
#knitr::include_graphics(here::here("figs/SurvsQStarts1ssv0.03.png"))
```

```{r PriorLowFits, fig.cap="Posterior predictive survival distributions from the Bayesian model ('local') assuming intensive monitoring (15 years of 45 collars per year) of populations from the 2.5% quantile of the national model. In these examples, the standard deviation the random effect prior (ssv: $\\sigma^2_S$ in Table @ref(tab:priors)) is 0.03, and  anthropogenic disturbance is 0. Bands show 95% posterior predictive intervals, black dots show true survival rates from the simulated population, and open triangles show observed survival rates.", cache=TRUE}
# COMMENTED OUT FOR NOW CAUSE I DIDN"T HAVE ACCESS
#knitr::include_graphics(here::here("figs/SurvsQStarts45lowssv0.03.png"))
```

```{r PriorAllFitsAnthro90, fig.cap="Differences between posterior predictive survival distributions from the Bayesian model ('local') and simulated outcomes from the national model ('national'), assuming minimal monitoring (1 years of 1 collar per year) of populations from the 50% quantile of the national model. In these examples, anthropogenic disturbance is 90%. When the multiplier on the prior standard deviation of the survival slope (bse: $\\beta^S_a$ in Table @ref(tab:priors)) is 3, the posterior survival distribution is similar to the distribution of simulated outcomes from the national model. Bands show 95% posterior predictive intervals ('local'), and the 2.5th and 97.5th percentiles for 1000 sample populations from the national model.", cache=TRUE}
knitr::include_graphics(here::here("figs/SurvsQStarts1Anthro90.png"))
```

```{r PriorHighFitsAnthro90, fig.cap="Posterior predictive survival distributions from the Bayesian model, assuming intensive monitoring (15 years of 45 collars per year) of populations from the 97.5% quantile of the national model. In these examples, anthropogenic disturbance is 90%, and the effect of anthropogenic disturbance varies from none (sS=0) through expected (sS=1) to double the expected slope (sS=2). All considered multipliers on the prior standard deviation of the survival slope (bse: $\\beta^S_a$ in Table @ref(tab:priors)) are sufficiently vague to reflect local variation among populations. Bands show 95% posterior predictive intervals, black dots show true survival rates from the simulated population, and open triangles show observed survival rates.", cache=TRUE}
knitr::include_graphics(here::here("figs/SurvsQStarts45Anthro90high.png"))
```



```{r PriorKSDistsRec, fig.cap="Prior parameter values should be set so that, given no monitoring data ('All' scenario), the posterior recruitment distribution is similar to the distribution of simulated outcomes from the national model, measured here by Komogorov-Smirnov distance [ks.test function in @R_R_2022]. Setting the multiplier on the prior standard deviation of the recruitment intercept (lre: $\\beta^R_0$ in Table @ref(tab:priors)) to 3, and values of the mean and standard deviations of the prior distribution of the random effect of year on recruitment to sre=0.23 and srv=0.22, respectively ($\\sigma^2_R$ in Table @ref(tab:priors)) allows us to meet this condition (Fig @ref(fig:priorAllFitsRec)). Priors should also be vague enough so that, given intensive monitoring of populations where recruitment is higher or lower than the national average ('High' and 'Low' scenarios: 15 years of 135 cows per year from 97.5% and 2.5% quantiles of the national model), posteriors reflect local recruitment, rather than priors from the national model. When the multiplier on the prior standard deviation of the recruitment intercept (lre: $\\beta^R_0$ in Table @ref(tab:priors)) is 1, the prior is not sufficiently vague to meet the latter condition (Fig @ref(fig:PriorLowFitsRec)). Anthropogenic disturbance is set to 0 in these scenarios." , cache=TRUE}
knitr::include_graphics(here::here("figs/PriorKSDistsRec.png"))
```

```{r PriorAllFitsRec, fig.cap="Differences between posterior predictive recruitment distributions from the Bayesian model ('local') and simulated outcomes from the national model ('national'), assuming no monitoring. In these examples, the standard deviation the random effect prior (srv: $\\sigma^2_R$ in Table @ref(tab:priors)) is 0.22, and  anthropogenic disturbance is 0. Bands show 95% posterior predictive intervals ('local'), and the 2.5th and 97.5th percentiles for 1000 sample populations from the national model.",  cache=TRUE}
knitr::include_graphics(here::here("figs/RecrQStarts1srv0.22.png"))
```

```{r PriorLowFitsRec, fig.cap="Posterior predictive recruitment distributions from the Bayesian model ('local') assuming intensive monitoring (135 cows per year for 15 years) of populations from the 2.5% quantile of the national model.  In these examples, the standard deviation the random effect prior (srv: $\\sigma^2_R$ in Table @ref(tab:priors)) is 0.22, and  anthropogenic disturbance is 0. Bands show 95% posterior predictive intervals, black dots show true recruitment rates from the simulated population, and open triangles show observed recruitment rates.", cache=TRUE}
knitr::include_graphics(here::here("figs/RecrQStarts45lowsrv0.22.png"))
```

```{r PriorAllFitsAnthro90Rec, fig.cap="Differences between posterior recruitment predictive distributions from the Bayesian model ('local') and simulated outcomes from the national model ('national'), assuming no monitoring. In these examples, anthropogenic disturbance is 90%. When the multiplier on the prior standard deviation of the slope of the relationship between recruitment and anthropogenic disturbance (bre: $\\beta^R_a$ in Table @ref(tab:priors)) is 4, the posterior recruitment distribution is similar to the distribution of simulated outcomes from the national model. Bands show 95% posterior predictive intervals ('local'), and the 2.5th and 97.5th percentiles for 1000 sample populations from the national model.", cache=TRUE}
knitr::include_graphics(here::here("figs/RecrQStarts1Anthro90.png"))
```

```{r PriorHighFitsAnthro90Rec, fig.cap="Posterior predictive recruitment distributions from the Bayesian model, assuming intensive monitoring (15 years of 135 collars per year) of populations from the 97.5% quantile of the national model. In these examples, anthropogenic disturbance is 90%, and the effect of anthropogenic disturbance varies from none (rS=0) through expected (rS=1) to double the expected slope (rS=2). All multipliers on the prior standard deviation of the survival slope (bre: $\\beta^R_a$ in Table @ref(tab:priors)) are sufficiently vague to reflect local variation among populations. Bands show 95% posterior predictive intervals, black dots show true recruitment rates from the simulated population, and open triangles show observed recruitment rates.", cache=TRUE}
knitr::include_graphics(here::here("figs/RecrQStarts45Anthro90high.png"))
```


\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies:

```{r colophon, cache = FALSE}
# which R packages and versions?
#if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? 
#if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```
